# 个人影视网站使用说明

## 🎉 恭喜！项目部署成功

您的个人影视网站已经成功部署并可以正常运行了！

## 📋 快速开始

### 1. 启动网站

```bash
# 开发环境（推荐用于个人使用）
python manage.py runserver

# 生产环境（适合多用户访问）
gunicorn -c deploy/gunicorn_config.py movieweb.wsgi:application
```

### 2. 访问网站

- **前台地址**：http://127.0.0.1:8000/
- **管理后台**：http://127.0.0.1:8000/admin/
- **管理员账号**：admin（密码是您刚才设置的）

## 🎬 开始使用

### 第一步：扫描视频文件

在使用网站前，您需要先扫描本地的视频文件：

```bash
# 扫描默认目录（D:\Videos）
python manage.py scan_videos

# 扫描指定目录
python manage.py scan_videos "D:\qbittorrent"

# 同时生成缩略图（需要安装FFmpeg）
python manage.py scan_videos "D:\qbittorrent" --generate-thumbnails

# 更新已存在的视频信息
python manage.py scan_videos "D:\qbittorrent" --update
```

> **提示**：扫描成功后应该看到类似以下输出：
> ```
> Scan completed. Added: 0, Updated: 24, Errors: 0
> ```

### 第二步：注册用户账号

1. 访问：http://127.0.0.1:8000/accounts/signup/
2. 注册新用户账号
3. 登录后可以享受完整功能

## 🔧 主要功能

### ✅ 已实现的功能

1. **视频管理**
   - 自动扫描本地视频文件
   - 支持多种格式：mp4, avi, mkv, mov, wmv, flv, webm, m4v
   - 自动提取视频信息（时长、大小等）
   - 生成视频缩略图

2. **在线播放**
   - HTML5视频播放器
   - 支持拖拽进度条
   - 自动保存观看进度
   - 继续观看功能

3. **用户系统**
   - 用户注册/登录
   - 密码修改
   - 观看历史记录
   - 个人评分系统

4. **搜索与筛选**
   - 标题和描述搜索
   - 按类型筛选
   - 分页显示

5. **评分评论**
   - 5星评分系统
   - 文字评论
   - 平均评分显示

6. **现代化界面**
   - 响应式设计
   - Bootstrap框架
   - 美观的卡片布局
   - 移动端适配

### 📱 界面预览

- **首页**：电影网格布局，搜索筛选功能
- **播放页**：大屏播放器 + 影片信息 + 评分区
- **个人中心**：观看历史，个人评分
- **管理后台**：影片管理，用户管理

## 🛠️ 高级配置

### 安装FFmpeg（推荐）

FFmpeg用于生成视频缩略图和提取视频信息：

1. 访问：https://ffmpeg.org/download.html
2. 下载Windows版本
3. 解压到合适位置（如 C:\ffmpeg）
4. 将bin目录添加到系统PATH
5. 验证：在命令行输入 `ffmpeg -version`

### 环境配置

创建 `.env` 文件来自定义配置：

```env
SECRET_KEY=your-secret-key-here
DEBUG=True
VIDEO_ROOT_PATH=D:\你的视频目录
ALLOWED_HOSTS=127.0.0.1,localhost
```

### 目录结构说明

```
movieweb/
├── movies/              # 影片应用
├── accounts/            # 用户管理应用
├── templates/           # HTML模板
├── static/             # 静态文件（CSS/JS）
├── media/              # 用户上传文件（缩略图）
├── deploy/             # 部署相关文件
├── docs/               # 文档
├── manage.py           # Django管理命令
├── requirements.txt    # Python依赖
└── 使用说明.md         # 本文件
```

## 🚀 生产部署

### 使用Gunicorn

```bash
# 安装依赖后运行
gunicorn -c deploy/gunicorn_config.py movieweb.wsgi:application
```

### 使用Nginx（可选）

1. 安装Nginx
2. 参考 `deploy/nginx.conf` 配置文件
3. 配置反向代理和静态文件服务

### 安全建议

1. 修改SECRET_KEY
2. 设置DEBUG=False
3. 配置ALLOWED_HOSTS
4. 使用HTTPS
5. 定期备份数据库

## 📚 常用命令

```bash
# 启动开发服务器
python manage.py runserver

# 创建管理员账号
python manage.py createsuperuser

# 扫描视频文件
python manage.py scan_videos "视频目录路径"

# 数据库操作
python manage.py makemigrations
python manage.py migrate

# 收集静态文件
python manage.py collectstatic

# 查看所有命令
python manage.py help
```

## 🆘 常见问题

### Q: 视频无法播放怎么办？
A: 检查视频文件路径是否正确，确认文件格式是否支持。

### Q: 缩略图不显示？
A: 确认FFmpeg已正确安装，重新扫描视频文件时添加 `--generate-thumbnails` 参数。

### Q: 如何添加新视频？
A: 将视频文件放入指定目录，然后运行扫描命令即可。

### Q: 如何批量管理影片？
A: 访问管理后台 http://127.0.0.1:8000/admin/ 进行批量操作。

### Q: 如何更改视频目录？
A: 修改 `.env` 文件中的 `VIDEO_ROOT_PATH` 配置。

### Q: 扫描视频时出现错误怎么办？
A: 
- 确保视频文件路径正确且文件未损坏
- 检查是否有足够的磁盘空间
- 如果是权限问题，以管理员身份运行命令
- 查看详细错误信息进行针对性解决

### Q: 扫描后在网站上看不到视频？
A: 
- 确认扫描完成时显示 "Errors: 0"
- 刷新网页或清除浏览器缓存
- 检查数据库是否正常写入：访问管理后台查看影片列表

## 🎯 后续优化建议

1. **性能优化**
   - 使用Redis缓存
   - CDN加速静态文件
   - 数据库查询优化

2. **功能扩展**
   - 收藏夹功能
   - 播放列表
   - 字幕支持
   - 视频转码

3. **用户体验**
   - 快捷键支持
   - 自动播放下一集
   - 观看进度同步

## 📞 技术支持

如果您在使用过程中遇到任何问题，可以：

1. 查看Django错误日志
2. 检查服务器运行状态
3. 验证文件路径和权限
4. 确认依赖包版本

## 🔄 版本更新日志

### v1.0.1 (最新)
- ✅ 修复了视频扫描时的json变量作用域错误
- ✅ 改进了错误处理机制
- ✅ 优化了扫描命令的稳定性

### v1.0.0 (初始版本)
- ✅ 完整的Django影视网站功能
- ✅ 用户认证和评分系统
- ✅ 视频播放和进度保存
- ✅ 响应式界面设计

---

**祝您使用愉快！🎉**

*这是一个基于Django的个人影视网站，采用前后端不分离架构，适合个人或小团队使用。* 